import{t as e}from"./arrow-left-mvEJW8ZQ.js";import{t}from"./calendar-4kT8YPNI.js";import{t as n}from"./heart-DjkT3NxO.js";import{t as r}from"./layers-CBq1KnbF.js";import{t as i}from"./log-in-CqCf8gaW.js";import{t as a}from"./message-circle-BtpWNYDD.js";import{_ as o,d as s,h as c,l,m as u,n as d,r as f,t as p,u as m,v as h}from"./index-C_gUkn22.js";var g=h(o(),1),_=d(),v=()=>{let{id:o}=c(),d=u(),{user:h,refreshUser:v}=p(),[y,b]=(0,g.useState)(null),[x,S]=(0,g.useState)(!0),[C,w]=(0,g.useState)(!1);(0,g.useEffect)(()=>{(async()=>{if(!o)return;let e=(await f.getArtworks()).find(e=>e.id===o);b(e||null),S(!1),e&&f.recordView(o)})()},[o]),(0,g.useEffect)(()=>{w(h&&y&&h.favorites?.includes(y.id)||!1)},[h,y]);let T=()=>{if(!h){window.confirm(`請先登入以進行預約。前往登入頁面？`)&&d(`/login`);return}d(`/calendar`,{state:{artwork:y}})},E=e=>{if(y){let e=`你好！我對這張作品 "${y.title}" (ID: ${y.id}) 有興趣，請問還有嗎？`;navigator.clipboard.writeText(e).catch(()=>{})}},D=async e=>{if(e.preventDefault(),!h){window.confirm(`請先登入才能使用收藏功能！前往登入頁面？`)&&d(`/login`);return}if(!y)return;let t=C;w(!C);try{await f.toggleFavorite(h.id,y.id),await v()}catch(e){w(t),console.error(`Toggle favorite failed`,e)}};if(x)return(0,_.jsx)(`div`,{className:`pt-20 text-center text-gray-500`,children:`載入中...`});if(!y)return(0,_.jsx)(`div`,{className:`pt-20 text-center text-gray-500`,children:`找不到此作品`});let O=y.status===l.AVAILABLE,k=`你好！我對這張作品 "${y.title}" (ID: ${y.id}) 有興趣，請問還有嗎？`,A=`https://line.me/R/oaMessage/@${m}/?${encodeURIComponent(k)}`;return(0,_.jsxs)(`div`,{className:`max-w-4xl mx-auto px-4 py-8`,children:[(0,_.jsxs)(`button`,{onClick:()=>d(-1),className:`flex items-center text-gray-400 hover:text-white mb-6`,children:[(0,_.jsx)(e,{size:20,className:`mr-2`}),` 返回`]}),(0,_.jsxs)(`div`,{className:`grid md:grid-cols-2 gap-8 md:gap-12`,children:[(0,_.jsxs)(`div`,{className:`relative rounded-xl overflow-hidden bg-card shadow-2xl`,children:[(0,_.jsx)(`img`,{src:y.imageUrl,alt:y.title,className:`w-full h-auto object-cover ${O?``:`grayscale opacity-70`}`}),!O&&(0,_.jsx)(`div`,{className:`absolute inset-0 flex items-center justify-center bg-black/40`,children:(0,_.jsx)(`span`,{className:`bg-red-600 text-white px-6 py-2 rounded-full text-xl font-bold uppercase rotate-[-12deg] border-2 border-white`,children:`已認領`})}),O&&y.specialPrice&&(0,_.jsx)(`div`,{className:`absolute top-4 left-4 bg-red-600 text-white px-3 py-1 rounded font-bold shadow-lg animate-pulse`,children:`特價中`}),(0,_.jsx)(`button`,{onClick:D,className:`absolute top-4 right-4 p-3 rounded-full transition-all hover:scale-110 z-10 shadow-lg ${C?`text-pink-500 bg-white/90 border-2 border-pink-500`:`text-gray-800 border-2 border-gray-800 bg-white/90 hover:border-pink-500 hover:text-pink-500`}`,children:(0,_.jsx)(n,{size:24,className:C?`fill-current`:``})})]}),(0,_.jsxs)(`div`,{className:`flex flex-col justify-center`,children:[(0,_.jsxs)(`div`,{className:`mb-6`,children:[(0,_.jsx)(`span`,{className:`inline-block px-3 py-1 bg-gray-800 text-primary text-xs rounded-full mb-3`,children:y.category}),(0,_.jsx)(`h1`,{className:`text-3xl md:text-4xl font-bold text-white mb-4`,children:y.title}),(0,_.jsx)(`p`,{className:`text-gray-300 leading-relaxed text-lg`,children:y.description})]}),(0,_.jsxs)(`div`,{className:`space-y-6`,children:[h&&(0,_.jsxs)(`div`,{className:`bg-card p-4 rounded-lg border border-white/5`,children:[(0,_.jsx)(`p`,{className:`text-sm text-gray-500 mb-1`,children:`預估價格`}),y.specialPrice?(0,_.jsxs)(`div`,{className:`flex items-baseline gap-3`,children:[(0,_.jsxs)(`p`,{className:`text-3xl font-bold text-red-500`,children:[`NT$ `,y.specialPrice.toLocaleString()]}),(0,_.jsxs)(`p`,{className:`text-lg text-gray-500 line-through`,children:[`NT$ `,y.price?.toLocaleString()]})]}):(0,_.jsxs)(`p`,{className:`text-2xl font-bold text-primary`,children:[`NT$ `,y.price?.toLocaleString()]}),h.role===s.GUEST&&(0,_.jsx)(`p`,{className:`text-xs text-gray-600 mt-1`,children:`* 登入以查看會員專屬價格`})]}),!h&&(0,_.jsxs)(`button`,{onClick:()=>d(`/login`),className:`w-full bg-[#06C755] hover:bg-[#05b34d] text-white font-bold py-4 px-6 rounded-xl flex items-center justify-center transition-all hover:scale-[1.02] shadow-lg`,children:[(0,_.jsx)(i,{className:`mr-3`,size:20}),`LINE 登入查看價格`]}),O?(0,_.jsxs)(`div`,{className:`space-y-3`,children:[y.pngUrl&&(0,_.jsxs)(`button`,{onClick:()=>d(`/preview?artworkId=${y.id}`),className:`w-full bg-gradient-to-r from-purple-600 to-pink-600 hover:from-purple-500 hover:to-pink-500 text-white font-bold py-4 px-6 rounded-xl flex items-center justify-center transition-all hover:scale-[1.02] shadow-lg shadow-purple-900/30`,children:[(0,_.jsx)(r,{className:`mr-3`,size:24}),`刺青預覽模擬`]}),(0,_.jsxs)(`button`,{onClick:T,className:`w-full bg-gray-800 hover:bg-gray-700 text-white font-bold py-4 px-6 rounded-xl flex items-center justify-center transition-colors border border-white/10`,children:[(0,_.jsx)(t,{className:`mr-3`,size:24}),`挑選想刺青的日期`]}),(0,_.jsxs)(`a`,{href:A,target:`_blank`,rel:`noreferrer`,onClick:E,className:`w-full bg-[#06c755] hover:bg-[#05b34c] text-white font-bold py-4 px-6 rounded-xl flex items-center justify-center transition-transform hover:scale-[1.02] shadow-lg shadow-green-900/20`,children:[(0,_.jsx)(a,{className:`mr-3`,size:24}),`LINE 諮詢`]}),(0,_.jsx)(`p`,{className:`text-[10px] text-gray-500 text-center`,children:`點擊後將自動複製詢問訊息`})]}):(0,_.jsx)(`button`,{disabled:!0,className:`w-full bg-gray-700 text-gray-400 font-bold py-4 px-6 rounded-xl cursor-not-allowed flex items-center justify-center`,children:`此圖已售出`}),(0,_.jsx)(`div`,{className:`flex flex-wrap gap-2 mt-6`,children:y.tags.map(e=>(0,_.jsxs)(`span`,{className:`text-xs text-gray-500`,children:[`#`,e]},e))})]})]})]})]})};export{v as default};